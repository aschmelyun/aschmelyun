<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="utf-8">
    <title>Why you should be using Vue&#039;s new Composition API - Andrew Schmelyun</title>

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="Vue 3 introduced the composition API and while it looks intimidating, here&#039;s a few practical examples of components rewritten using this new interface.">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Why you should be using Vue&#039;s new Composition API" />
    <meta property="og:description" content="Vue 3 introduced the composition API and while it looks intimidating, here&#039;s a few practical examples of components rewritten using this new interface." />
    <meta property="og:url" content="https://aschmelyun.com/blog/why-you-should-be-using-vue-new-composition-api" />
    <meta property="og:site_name" content="Andrew Schmelyun" />
            <meta name="og:image" content="https://aschmelyun.com/assets/images/meta/blog/why-you-should-be-using-vue-new-composition-api.jpg" />
    
    <meta name="twitter:description" content="Vue 3 introduced the composition API and while it looks intimidating, here&#039;s a few practical examples of components rewritten using this new interface." />
    <meta name="twitter:title" content="Why you should be using Vue&#039;s new Composition API" />
    <meta name="twitter:site" content="@aschmelyun" />
            <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:image" content="https://aschmelyun.com/assets/images/meta/blog/why-you-should-be-using-vue-new-composition-api.jpg" />
    
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicon-16x16.png">
    <meta name="theme-color" content="#1a202c">

    <link rel="stylesheet" type="text/css" href="/assets/css/app.css?id=d3daf746e8f437aa6da7">
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-62877530-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-62877530-1');
    </script>
</head>
<body class="">
<div class="container mx-auto pb-6 md:pb-12 antialiased">
    <div class="w-auto mx-4 lg:w-4/5 lg:mx-auto">
        <header class="text-gray-900 font-semibold">
    <div class="container mx-auto flex flex-wrap py-4 flex-col md:flex-row items-center">
        <a href="/" id="link-home" class="flex title-font font-medium items-center text-gray-900 mb-4 md:mb-0 hover:opacity-75 transition-opacity duration-200">
            <img src="/assets/images/andrew-schmelyun-profile.jpg" alt="Andrew Schmelyun profile picture" class="w-24 h-24 rounded-full">
        </a>
        <nav class="w-full md:w-auto md:ml-auto flex flex-wrap items-center text-lg justify-around lg:justify-center">
            <a href="/blog" class="inline-flex bg-white text-gray-900 mr-0 lg:mr-6 hover:bg-gray-200 border-0 py-1 px-3 focus:outline-none transition-colors duration-200">Blog</a>
            <a href="/videos" class="inline-flex bg-white text-gray-900 mr-0 lg:mr-6 hover:bg-gray-200 border-0 py-1 px-3 focus:outline-none transition-colors duration-200">Videos</a>
            <a href="/uses" class="inline-flex bg-white text-gray-900 mr-0 lg:mr-6 hover:bg-gray-200 border-0 py-1 px-3 focus:outline-none transition-colors duration-200">Uses</a>
            <a href="/projects" class="inline-flex bg-white text-gray-900 mr-0 lg:mr-6 hover:bg-gray-200 border-0 py-1 px-3 focus:outline-none transition-colors duration-200">Projects</a>
        </nav>
        <a href="https://aschmelyun.substack.com" class="inline-flex items-center bg-gray-200 text-gray-900 border-0 py-1 px-3 focus:outline-none hover:bg-gray-900 hover:text-white font-semibold text-lg mt-4 md:mt-0 transition-colors duration-200">Newsletter
            <svg fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="w-4 h-4 ml-1" viewBox="0 0 24 24">
                <path d="M5 12h14M12 5l7 7-7 7"></path>
            </svg>
        </a>
    </div>
</header>
        <section class="text-gray-600 body-font overflow-hidden mt-4 lg:mt-16">
    <h1 class="text-3xl lg:text-4xl text-gray-900 font-medium relative">Why you should be using Vue&#039;s new Composition API</h1>
    <div class="pt-4 pb-12 w-full flex flex-col items-start">
        <div class="mb-8 flex items-center">
            <span class="inline-block mr-4 text-gray-900 font-medium">Published <time datetime="2021-08-26 00:00:00">Aug 26 2021</time></span>
                            <span class="inline-block py-0.5 px-2 mr-2 rounded bg-white text-gray-600 border border-gray-600 text-xs font-medium tracking-widest tag-vue">VUE</span>
                            <span class="inline-block py-0.5 px-2 mr-2 rounded bg-white text-gray-600 border border-gray-600 text-xs font-medium tracking-widest tag-javascript">JAVASCRIPT</span>
                    </div>
        <div class="leading-relaxed blog-content w-full"><p>You keep hearing about this <a href="https://v3.vuejs.org/guide/composition-api-introduction.html">composition API</a> in Vue. But it's a little scary and intimidating, and why it's so much better isn't really all that clear to you.</p>
<p>In this article you'll see exactly why you should learn to use it by comparing the old way to the new way. The examples also start out simple and get more complex, so you can see that the composition API isn't really all that different from what you're used to.</p>
<p>This replaces Vue 2's current options API, but the good news is that you aren't <em>required</em> to use it in Vue 3 applications. You can still use the tried-and-true options API and write your components just like you would have previously in Vue 2. For those who want to adopt this new method now or just want to familiarize with the updates, here's a few examples of some common, simple components, re-written using Vue 3's composition API.</p>
<h2>A simple counter</h2>
<p>Pretty much the go-to &quot;Hello world&quot; of frontend frameworks, the counter component. Let's see what one looks like in Vue 2:</p>
<pre><code class="language-vue">&lt;template&gt;
  &lt;div class="counter"&gt;
    &lt;span&gt;{{ counter }}&lt;/span&gt;
    &lt;button @click="counter += 1"&gt;+1&lt;/button&gt;
    &lt;button @click="counter -= 1"&gt;-1&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
export default {
  data() {
    return {
      counter: 0
    }
  }
}
&lt;/script&gt;</code></pre>
<p>We're displaying a span tag with a counter data object, which starts at zero. We then have two buttons with <code>v-on:click</code> attributes and inline code telling them to increase, or decrease, the counter by one. Then in the script tag, we're initializing that counter through a returned object in the data method.</p>
<p>Now let's take a look at what the same component looks like in Vue 3:</p>
<pre><code class="language-vue">&lt;template&gt;
  &lt;span&gt;{{ counter }}&lt;/span&gt;
  &lt;button @click="counter += 1"&gt;+1&lt;/button&gt;
  &lt;button @click="counter -= 1"&gt;-1&lt;/button&gt;
&lt;/template&gt;
&lt;script&gt;
import { ref } from 'vue';
export default {
  setup() {
    const counter = ref(0);

    return {
      counter
    };
  }
}
&lt;/script&gt;</code></pre>
<p>The first thing you might notice is that I've <strong>removed that wrapper div</strong> from the template. Previously in Vue, you'd get an error if you tried to render a component with more than one top-level element under the template tag. In Vue 3, this is no longer the case!</p>
<p>Moving down to the script section, it's a little longer than the previous component. That's kind of to be expected though, since our functionality is the bare minimum and there's <em>slightly</em> more setup with the composition API. Let's go over the changes line-by-line.</p>
<pre><code class="language-vue">import { ref } from 'vue';</code></pre>
<p>The <code>ref</code> method is required in order to give any data point <a href="https://v3.vuejs.org/api/refs-api.html">reactivity</a> in the composition API. By default, variables returned from the <code>setup</code> method are <em>not</em> reactive.</p>
<pre><code class="language-vue">export default {
  setup() { ... }
}</code></pre>
<p>Next, we have the new <code>setup</code> method. This is the entrypoint for all composition API components, and anything in the returned object from it will be exposed to the rest of our component. This includes things like computed properties, data objects, methods, and component lifecycle hooks.</p>
<pre><code class="language-vue">setup() {
  const counter = ref(0);

  return {
    counter
  };
}</code></pre>
<p>We're first creating a counter using the previously-mentioned <code>ref</code> method, and passing it the initial value, zero. Then, all we have to do is return that counter, wrapped in an object.</p>
<p>From there, our component works just like it previously did, displaying the current value and allowing the user to adjust it based on the button presses given! Let's move on and take a look at something with a little more moving parts.</p>
<h2>A shopping cart</h2>
<p>Moving up in complexity, we'll create a component that uses two common attributes in Vue, computed properties and defined methods. I think a great example for that would be a basic shopping cart component, which shows items that a user has selected on something like an e-commerce website.</p>
<p>Here's an example of that in Vue 2 using the options API:</p>
<pre><code class="language-vue">&lt;template&gt;
    &lt;div class="cart"&gt;
        &lt;div class="row" v-for="(item, index) in items"&gt;
            &lt;span&gt;{{ item.name }}&lt;/span&gt;
            &lt;span&gt;{{ item.quantity }}&lt;/span&gt;
            &lt;span&gt;{{ item.price * item.quantity }}&lt;/span&gt;
            &lt;button @click="removeItem(index)"&gt;Remove&lt;/button&gt;
        &lt;/div&gt;
        &lt;div class="row"&gt;
            &lt;h3&gt;Total: &lt;span&gt;{{ cartTotal }}&lt;/span&gt;&lt;/h3&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
export default {
    data() {
        return {
            items: [
                {
                    name: "Cool Gadget",
                    quantity: 3,
                    price: 19.99
                },
                {
                    name: "Mechanical Keyboard",
                    quantity: 1,
                    price: 129.99
                }
            ]
        }
    },
    methods: {
        removeItem(index) {
            this.items.splice(index, 1);
        }
    },
    computed: {
        cartTotal() {
            return this.items.reduce((total, item) =&gt; {
                return total += (item.price * item.quantity);
            }, 0);
        }
    }
}
&lt;/script&gt;</code></pre>
<p>Items in the cart are listed with <code>v-for</code>, and a button is present after each one to remove it from the main array on click. The total cost of the cart is calculated through a computed property that uses <code>reduce</code> and the value is displayed at the bottom of the items. Pretty straightforward, I think!</p>
<p>Let's see what a similar component with these attributes looks like in Vue 3 using the composition API:</p>
<pre><code class="language-vue">&lt;template&gt;
    &lt;div class="cart"&gt;
        &lt;div class="row" v-for="(item, index) in items"&gt;
            &lt;span&gt;{{ item.name }}&lt;/span&gt;
            &lt;span&gt;{{ item.quantity }}&lt;/span&gt;
            &lt;span&gt;{{ item.price * item.quantity }}&lt;/span&gt;
            &lt;button @click="removeItem(index)"&gt;Remove&lt;/button&gt;
        &lt;/div&gt;
        &lt;div class="row"&gt;
            &lt;h3&gt;Total: &lt;span&gt;{{ cartTotal }}&lt;/span&gt;&lt;/h3&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
import { ref, computed } from 'vue';
export default {
    setup() {
        const items = ref([
            {
                name: "Cool Gadget",
                quantity: 3,
                price: 19.99
            },
            {
                name: "Mechanical Keyboard",
                quantity: 1,
                price: 129.99
            }
        ]);

        const removeItem = (index) =&gt; {
            items.value.splice(index, 1);
        };

        const cartTotal = computed(() =&gt; {
            return items.value.reduce((total, item) =&gt; {
                return total += (item.price * item.quantity);
            }, 0);
        });

        return {
            items,
            removeItem,
            cartTotal
        };
    }
}
&lt;/script&gt;</code></pre>
<p>The biggest difference is that the computed property and method aren't in their own properties in the root Vue object, instead they're just plain methods defined and returned in the main <code>setup()</code> method.</p>
<p>For methods, we just create them as functions:</p>
<pre><code class="language-vue">const removeItem = (index) =&gt; {
    items.value.splice(index, 1);
};</code></pre>
<p>And as long as we include them in the returned object, they're exposed to (and can be used by) the rest of the component. Computed properties are almost the exact same, with the exception of being wrapped in a <code>computed</code> method that's imported from the main Vue package:</p>
<pre><code class="language-vue">const cartTotal = computed(() =&gt; {
    return items.value.reduce((total, item) =&gt; {
        return total += (item.price * item.quantity);
    }, 0);
});</code></pre>
<p>This way, <strong>we can de-couple parts of our components</strong> and separate them even further into portions of functionality that can be re-used and imported into multiple other components. We'll see how to do this in our next example.</p>
<p>For instance, if we wanted to, we could easily split out the <code>cartTotal</code> computed property or the <code>removeItem</code> method into their <em>own files</em>. Then instead of defining and using them in the main component above, we'd import them and just call the designated method.</p>
<p>On to the last component!</p>
<h2>A like button</h2>
<p>Our third and final example is even more complex than the last two, let's see what a component would look like that has to pull in data from an API endpoint and react to user input.</p>
<p>This is what that might look like with the options API in a Vue 2 application:</p>
<pre><code class="language-vue">&lt;template&gt;
  &lt;button @click="sendLike" :disabled="isDisabled"&gt;{{ likesAmount }}&lt;/button&gt;
&lt;/template&gt;
&lt;script&gt;
export default {
  data() {
    return {
      likes: 0,
      isDisabled: false
    }
  },
  mounted() {
      fetch('/api/post/1')
          .then((response) =&gt; response.json())
          .then((data) =&gt; {
              this.likes = data.post.likes;
          });
  },
  methods: {
    sendLike() {
      this.isDisabled = true;
      this.likes++;

      fetch('/api/post/1/likes', {
        method: 'POST'
      })
        .then((response) =&gt; {
          this.isDisabled = false;
        }
        .catch((error) =&gt; {
          this.likes--;
          this.isDisabled = false;
        });
    }
  },
  computed: {
      likesAmount() {
          return this.likes + ' people have liked this';
      }
  }
}
&lt;/script&gt;</code></pre>
<p>A little more complicated than our previous examples, but let's break it down.</p>
<p>We're starting off in the template with a button, that has a <code>v-on:click</code> bind to a <code>sendLike</code> method, and a bound disabled attribute to the data attribute <code>isDisabled</code>. Inside of that button we're showing the amount of likes with a <code>likes</code> data attribute.</p>
<p>Moving through to the script, we're initializing the data object returned with 0 <code>likes</code>, and <code>isDisabled</code> set to false. We're using the <code>mounted()</code> lifecycle method to call an API endpoint and set the amount of likes to a specific post's likes.</p>
<p>Then we define a <code>sendLike</code> method, which disables the button and increases the likes by 1. (We're increasing the likes <em>before</em> actually sending the request so that our user interaction is recorded immediately.)</p>
<p>Finally, we send the request to our make-believe API, and await the response. Either way, we remove the disabled attribute from the button, but if the server returns an error for some reason, we remove the initial like that was recorded and reset <code>likes</code> to the previous value.</p>
<p>Now, let's see what a similar component would look like in Vue 3 using the composition API:</p>
<pre><code class="language-vue">&lt;template&gt;
  &lt;button @click="sendLike" :disabled="isDisabled"&gt;{{ likesAmount }}&lt;/button&gt;
&lt;/template&gt;
&lt;script&gt;
import { ref, computed, onMounted } from 'vue';
export default {
  setup() {
    const likes = ref(0);
    const isDisabled = ref(false);

    onMounted(() =&gt; {
        fetch('/api/post/1')
            .then((response) =&gt; response.json())
            .then((data) =&gt; {
                likes = data.post.likes;
            });
    });

    const sendLike = async () =&gt; {
        isDisabled.value = true;
        likes.value++;

        fetch('/api/post/1/likes', {
            method: 'POST'
        })
            .then((response) =&gt; {
                isDisabled.value = false;
            })
            .catch((error) =&gt; {
                likes.value--;
                isDisabled.value = false;
            });
    }

    const likesAmount = computed(() =&gt; {
        return likes.value + ' people have liked this';
    });

    return {
      likes,
      isDisabled,
      likesAmount,
      sendLike
    };
  }
}
&lt;/script&gt;</code></pre>
<p>Alright, there it is!</p>
<p>Now, a main difference between this and our counter component is the addition of a <strong>mounted</strong> lifecycle hook. Instead of being another separate method like in Vue 2's options API, this is again just written as a function in <code>setup</code>, wrapped in an included <code>onMounted()</code> method.</p>
<p>This is where the composition API can start to shine with composables. This like button component is getting a little long, and it includes some functionality that could be split out into a separate file and imported instead.</p>
<p>For example, we might want to include the retrieval and updating of likes in different components, so we can create a new JavaScript file which handles just that:</p>
<pre><code class="language-js">// useLikes.js
import { ref, computed, onMounted } from 'vue';

export default function useLikes(postId) {
    const likes = ref(0);
    const likesAmount = computed(() =&gt; {
        return likes + ' people have liked this'
    });

    onMounted(() =&gt; {
        fetch(`/api/posts/${postId}`)
            .then((response) =&gt; response.json())
            .then((data) =&gt; {
                likes.value = data.post.likes;
            });
    });

    return {
        likes,
        likesAmount
    }
}</code></pre>
<p>This renderless component, <code>useLikes</code>, initiates the placeholder likes amount, 0. It then sends a fetch request to the API endpoint of the post whose ID is passed in. After that completes, our likes are then updated to match whatever is attributed to that current post.</p>
<p>So, how's this used back in our main component? Like this:</p>
<pre><code class="language-vue">&lt;template&gt;
  &lt;button @click="sendLike" :disabled="isDisabled"&gt;{{ likesAmount }}&lt;/button&gt;
&lt;/template&gt;
&lt;script&gt;
import { useLikes } from '@/useLikes';
import { ref, computed, onMounted } from 'vue';
export default {
  setup() {
    const {
        likes,
        likesAmount
    } = useLikes(1);

    const isDisabled = ref(false);

    const sendLike = async () =&gt; {
        isDisabled.value = true;
        likes.value++;

        fetch('/api/post/1/likes', {
            method: 'POST'
        })
            .then((response) =&gt; {
                isDisabled.value = false;
            })
            .catch((error) =&gt; {
                likes.value--;
                isDisabled.value = false;
            });
    }

    return {
      likes,
      isDisabled,
      likesAmount,
      sendLike
    };
  }
}
&lt;/script&gt;</code></pre>
<p>First we use an import statement to get our exported <code>useLikes</code> function, and then use a destructured object that consists of the <strong>likes</strong> and <strong>likesAmount</strong> ref object and method respectively. They're brought into our main component through that same <code>useLikes</code> function.</p>
<p>All that was left to do was pass in the <code>postId</code> attribute, which we've set as a hard-coded value to 1.</p>
<h2>Wrapping up</h2>
<p>Well, there you have it! You've seen <strong>three different components</strong> that were created in Vue 2, and then their counterparts replicated in Vue 3.</p>
<p>Whether you're a developer experienced in the framework, or one who's still learning the ropes, I hope these helped you on your journey through this newest version of Vue. Despite its different, sometimes intimidating appearance, the composition API can help you organize and refactor your frontend code in a more stable and maintainable way.</p>
<p>If you have any questions, comments, or want to chat more about web development in general, don’t hesitate to reach out on <a href="https://twitter.com/aschmelyun">Twitter</a>!</p></div>
    </div>
</section>        <footer class="text-gray-600 body-font overflow-hidden mt-12">
    <div class="flex flex-wrap -mx-4 -mb-10 text-center items-center justify-between">
        <div class="w-full lg:w-1/2 mb-10 px-4 text-center lg:text-left">
            <p class="mb-2 font-medium text-gray-900">&copy;2021 Andrew Schmelyun</p>
            <p>This site is powered by <a href="https://github.com/aschmelyun/cleaver" target="_blank" rel="noreferrer" class="inline-block py-0.5 px-2 rounded bg-white text-gray-600 border border-gray-600 text-xs font-medium tracking-widest hover:bg-gray-600 hover:text-white transition-colors duration-200">CLEAVER 🔥🔪</a></p>
        </div>
        <div class="w-full lg:w-1/2 mb-10 px-4 text-center lg:text-right">
            <p class="mb-2 font-medium text-gray-900">Follow me</p>
                        <p>
                                    <a href="https://github.com/aschmelyun" target="_blank" rel="noreferrer" class="text-gray-600 hover:text-gray-900 transition-colors duration-200">GitHub</a>
                                            &nbsp;&mdash;&nbsp;
                                                        <a href="https://twitter.com/aschmelyun" target="_blank" rel="noreferrer" class="text-gray-600 hover:text-gray-900 transition-colors duration-200">Twitter</a>
                                            &nbsp;&mdash;&nbsp;
                                                        <a href="https://youtube.com/aschmelyun" target="_blank" rel="noreferrer" class="text-gray-600 hover:text-gray-900 transition-colors duration-200">YouTube</a>
                                            &nbsp;&mdash;&nbsp;
                                                        <a href="https://dev.to/aschmelyun" target="_blank" rel="noreferrer" class="text-gray-600 hover:text-gray-900 transition-colors duration-200">Dev.to</a>
                                                </p>
        </div>
    </div>
</footer>
<script type="text/javascript" src="/assets/js/app.js?id=d67be835fdaca4b02a6f"></script>
    </div>
</div>
</body>
</html>